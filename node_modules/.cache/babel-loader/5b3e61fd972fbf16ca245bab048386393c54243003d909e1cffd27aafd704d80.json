{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (!it) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n      var F = function F() {};\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n  var normalCompletion = true,\n    didErr = false,\n    err;\n  return {\n    s: function s() {\n      it = it.call(o);\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it[\"return\"] != null) it[\"return\"]();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}\nfunction _defineProperty(obj, key, value) {\n  key = _toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}\nfunction _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\nimport AutoComplete from \"src/decidim/autocomplete\";\n$(function () {\n  var searchInput = document.getElementById(\"tc-autocomplete\");\n  var resultsElement = document.getElementById(\"add-translations-results\");\n  var template = resultsElement.querySelector(\"template\");\n  var form = searchInput.closest(\"form\");\n  var searchUrl = new URL(form.getAttribute(\"action\"), window.location.origin);\n  var currentSearch = \"\";\n  var selectedTerms = [];\n  searchInput.addEventListener(\"keyup\", function () {\n    currentSearch = searchInput.value;\n  });\n\n  // Prevent accidental submit on the autocomplete field\n  form.addEventListener(\"submit\", function (ev) {\n    return ev.preventDefault();\n  });\n  var dataSource = function dataSource(query, callback) {\n    var baseParams = Object.fromEntries(searchUrl.searchParams.entries());\n    var params = new URLSearchParams(_objectSpread(_objectSpread({}, baseParams), {}, {\n      term: query\n    }));\n    fetch(\"\".concat(searchUrl.pathname, \"?\").concat(params.toString()), {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }).then(function (response) {\n      return response.json();\n    }).then(function (data) {\n      callback(data);\n    });\n  };\n\n  // Just to avoid the \"no-new\" ESLint issue, wrap this in a function\n  var initiate = function initiate() {\n    var config = JSON.parse(searchInput.dataset.autocomplete);\n    return new AutoComplete(searchInput, {\n      name: searchInput.getAttribute(\"name\"),\n      placeholder: searchInput.getAttribute(\"placeholder\"),\n      searchPrompt: true,\n      searchPromptText: config.searchPromptText,\n      threshold: 3,\n      dataMatchKeys: [\"label\"],\n      modifyResult: function modifyResult(item, valueItem) {\n        var sanitizedSearch = currentSearch.replace(/[-/\\\\^$*+?.()|[\\]{}]/g, \"\\\\$&\");\n        var re = new RegExp(\"(\".concat(sanitizedSearch, \")\"), \"gi\");\n        var replacedText = item.textContent.replace(re, '<strong class=\"search-highlight\">$1</strong>');\n        item.innerHTML = replacedText;\n        item.dataset.value = valueItem.value;\n      },\n      dataSource: dataSource\n    });\n  };\n\n  // Method for hiding the currently selected items\n  var hideSelectedItems = function hideSelectedItems() {\n    var resultsList = searchInput.nextSibling;\n    var _iterator = _createForOfIteratorHelper(resultsList.querySelectorAll(\"li\")),\n      _step;\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var resultItem = _step.value;\n        if (selectedTerms.indexOf(resultItem.dataset.value) < 0) {\n          resultItem.classList.remove(\"hide\");\n        } else {\n          resultItem.classList.add(\"hide\");\n        }\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n  };\n  initiate();\n\n  // Currently not possible in Decidim to get notified when the list is\n  // modified, so hack it with a MutationObserver.\n  // Create an observer instance linked to the callback function\n  var observer = new MutationObserver(function () {\n    hideSelectedItems();\n  });\n  observer.observe(searchInput.nextSibling, {\n    childList: true\n  });\n\n  // Hide the already selected items when the input is opened\n  // Handle the selection of an item\n  searchInput.addEventListener(\"selection\", function (ev) {\n    var selection = ev.detail.selection;\n    var selectedItem = selection.value;\n    var newRow = template.content.cloneNode(true).querySelector(\"tr\");\n    newRow.innerHTML = newRow.innerHTML.replace(new RegExp(\"{{translation_key}}\", \"g\"), selectedItem.value);\n    newRow.innerHTML = newRow.innerHTML.replace(new RegExp(\"{{translation_term}}\", \"g\"), selectedItem.label);\n    var targetTable = resultsElement.querySelector(\"table tbody\");\n    targetTable.appendChild(newRow);\n    resultsElement.classList.remove(\"hide\");\n\n    // Add it to the selected elements and hide the selected item\n    selectedTerms.push(selectedItem.value);\n    hideSelectedItems();\n\n    // Listen to the click event on the remove button\n    newRow.querySelector(\".remove-translation-key\").addEventListener(\"click\", function (removeEv) {\n      removeEv.preventDefault();\n      newRow.parentNode.removeChild(newRow);\n      selectedTerms = selectedTerms.filter(function (item) {\n        return item !== selectedItem.value;\n      });\n      hideSelectedItems();\n      if (targetTable.querySelectorAll(\"tr\").length < 1) {\n        resultsElement.classList.add(\"hide\");\n      }\n    });\n  });\n});","map":{"version":3,"names":["AutoComplete","$","searchInput","document","getElementById","resultsElement","template","querySelector","form","closest","searchUrl","URL","getAttribute","window","location","origin","currentSearch","selectedTerms","addEventListener","value","ev","preventDefault","dataSource","query","callback","baseParams","Object","fromEntries","searchParams","entries","params","URLSearchParams","_objectSpread","term","fetch","concat","pathname","toString","method","headers","then","response","json","data","initiate","config","JSON","parse","dataset","autocomplete","name","placeholder","searchPrompt","searchPromptText","threshold","dataMatchKeys","modifyResult","item","valueItem","sanitizedSearch","replace","re","RegExp","replacedText","textContent","innerHTML","hideSelectedItems","resultsList","nextSibling","_iterator","_createForOfIteratorHelper","querySelectorAll","_step","s","n","done","resultItem","indexOf","classList","remove","add","err","e","f","observer","MutationObserver","observe","childList","selection","detail","selectedItem","newRow","content","cloneNode","label","targetTable","appendChild","push","removeEv","parentNode","removeChild","filter","length"],"sources":["/home/amandamaduro/.rbenv/versions/3.0.2/lib/ruby/gems/3.0.0/bundler/gems/decidim-module-term_customizer-5a8d4c67972e/app/packs/src/decidim/term_customizer/admin/translations_admin.js"],"sourcesContent":["import AutoComplete from \"src/decidim/autocomplete\";\n\n$(() => {\n  const searchInput = document.getElementById(\"tc-autocomplete\");\n  const resultsElement = document.getElementById(\"add-translations-results\");\n  const template = resultsElement.querySelector(\"template\");\n  const form = searchInput.closest(\"form\");\n  const searchUrl = new URL(form.getAttribute(\"action\"), window.location.origin);\n  let currentSearch = \"\";\n  let selectedTerms = [];\n\n  searchInput.addEventListener(\"keyup\", () => {\n    currentSearch = searchInput.value;\n  });\n\n  // Prevent accidental submit on the autocomplete field\n  form.addEventListener(\"submit\", (ev) => ev.preventDefault());\n\n  const dataSource = (query, callback) => {\n    const baseParams = Object.fromEntries(searchUrl.searchParams.entries());\n    const params = new URLSearchParams({ ...baseParams, term: query });\n    fetch(`${searchUrl.pathname}?${params.toString()}`, {\n      method: \"GET\",\n      headers: { \"Content-Type\": \"application/json\" }\n    }).then((response) => response.json()).then((data) => {\n      callback(data);\n    });\n  };\n\n  // Just to avoid the \"no-new\" ESLint issue, wrap this in a function\n  const initiate = () => {\n    const config = JSON.parse(searchInput.dataset.autocomplete);\n\n    return new AutoComplete(searchInput, {\n      name: searchInput.getAttribute(\"name\"),\n      placeholder: searchInput.getAttribute(\"placeholder\"),\n      searchPrompt: true,\n      searchPromptText: config.searchPromptText,\n      threshold: 3,\n      dataMatchKeys: [\"label\"],\n      modifyResult: (item, valueItem) => {\n        const sanitizedSearch = currentSearch.replace(/[-/\\\\^$*+?.()|[\\]{}]/g, \"\\\\$&\");\n        const re = new RegExp(`(${sanitizedSearch})`, \"gi\");\n        const replacedText = item.textContent.replace(re, '<strong class=\"search-highlight\">$1</strong>');\n        item.innerHTML = replacedText;\n        item.dataset.value = valueItem.value;\n      },\n      dataSource\n    });\n  };\n\n  // Method for hiding the currently selected items\n  const hideSelectedItems = () => {\n    const resultsList = searchInput.nextSibling;\n    for (const resultItem of resultsList.querySelectorAll(\"li\")) {\n      if (selectedTerms.indexOf(resultItem.dataset.value) < 0) {\n        resultItem.classList.remove(\"hide\");\n      } else {\n        resultItem.classList.add(\"hide\");\n      }\n    }\n  };\n\n  initiate();\n\n  // Currently not possible in Decidim to get notified when the list is\n  // modified, so hack it with a MutationObserver.\n  // Create an observer instance linked to the callback function\n  const observer = new MutationObserver(() => {\n    hideSelectedItems();\n  });\n  observer.observe(searchInput.nextSibling, { childList: true });\n\n  // Hide the already selected items when the input is opened\n  // Handle the selection of an item\n  searchInput.addEventListener(\"selection\", (ev) => {\n    const selection = ev.detail.selection;\n    const selectedItem = selection.value;\n    const newRow = template.content.cloneNode(true).querySelector(\"tr\");\n    newRow.innerHTML = newRow.innerHTML.replace(new RegExp(\"{{translation_key}}\", \"g\"), selectedItem.value);\n    newRow.innerHTML = newRow.innerHTML.replace(new RegExp(\"{{translation_term}}\", \"g\"), selectedItem.label);\n\n    const targetTable = resultsElement.querySelector(\"table tbody\");\n    targetTable.appendChild(newRow);\n    resultsElement.classList.remove(\"hide\");\n\n    // Add it to the selected elements and hide the selected item\n    selectedTerms.push(selectedItem.value);\n    hideSelectedItems();\n\n    // Listen to the click event on the remove button\n    newRow.querySelector(\".remove-translation-key\").addEventListener(\"click\", (removeEv) => {\n      removeEv.preventDefault();\n      newRow.parentNode.removeChild(newRow);\n      selectedTerms = selectedTerms.filter((item) => item !== selectedItem.value);\n      hideSelectedItems();\n\n      if (targetTable.querySelectorAll(\"tr\").length < 1) {\n        resultsElement.classList.add(\"hide\");\n      }\n    });\n  });\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}